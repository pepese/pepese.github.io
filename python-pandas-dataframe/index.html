<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="ぺーぺーSEのブログ">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://blog.pepese.com//">
    <meta property="twitter:image" content="https://blog.pepese.com//" />
    

    
    <meta name="title" content="Pandas入門 DataFrame編" />
    <meta property="og:title" content="Pandas入門 DataFrame編" />
    <meta property="twitter:title" content="Pandas入門 DataFrame編" />
    

    
    <meta name="description" content="ぺーぺーSEがテックネタを書きます。">
    <meta property="og:description" content="ぺーぺーSEがテックネタを書きます。" />
    <meta property="twitter:description" content="ぺーぺーSEがテックネタを書きます。" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="ぺーぺーSE, ぺーぺーSEのブログ, Web, Istio, Kubernetes, Microservice">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Pandas入門 DataFrame編-ぺーぺーSEのブログ</title>

    <link rel="canonical" href="/python-pandas-dataframe/">

    
    
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hugo-theme-cleanwhite.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link href="https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css" rel="stylesheet" type="text/css">

    
    

    
    <script src="/js/jquery.min.js"></script>

    
    <script src="/js/bootstrap.min.js"></script>

    
    <script src="/js/hux-blog.min.js"></script>

    
    

    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0116602540349648"
     crossorigin="anonymous"></script>

</head>




<nav class="navbar navbar-default navbar-custom navbar-fixed-top">

    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">ぺーぺーSEのブログ</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                        <li>
                            <a href="/categories/tech">tech</a>
                        </li>
                        
                    
                    
		    
                        <li><a href="/top/archive/">ARCHIVE</a></li>
                    

                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/')
    }
</style>

<header class="intro-header" >

    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/python" title="python">
                            python
                        </a>
                        
                        <a class="tag" href="/tags/pandas" title="pandas">
                            pandas
                        </a>
                        
                        <a class="tag" href="/tags/dataframe" title="dataframe">
                            dataframe
                        </a>
                        
                    </div>
                    <h1>Pandas入門 DataFrame編</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        
                            2018-02-04
                            
                            
                            
                            
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                
                <p>Python ライブラリである Pandas の DataFrame についてまとめる。</p>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">公式ドキュメント</a></li>
</ul>
<h1 id="基本操作">基本操作</h1>
<h2 id="dataframe-の作成">DataFrame の作成</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>DataFrame([[<span style="color:#f1fa8c">&#34;Taro&#34;</span>, <span style="color:#bd93f9">10</span>], [<span style="color:#f1fa8c">&#34;Jiro&#34;</span>, <span style="color:#bd93f9">20</span>], [<span style="color:#f1fa8c">&#34;Goro&#34;</span>, <span style="color:#ff79c6">None</span>]], columns<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#34;name&#34;</span>, <span style="color:#f1fa8c">&#34;age&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    age  name
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>  Taro  <span style="color:#bd93f9">10.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>  Jiro  <span style="color:#bd93f9">20.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>  Goro   NaN
</span></span></code></pre></div><p>リストや NumPy の ndarray をそのまま DataFrame にできる。<br>
以降のプログラム例では、上記の DataFrame を操作する例とする。</p>
<h2 id="データのロード">データのロード</h2>
<p><code>read_csv()</code> と <code>read_table()</code> はデフォルトの区切り文字が違うだけで中身は同じ。<br>
<code>read_csv()</code> はカンマ、 <code>read_table()</code> はタブ。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>read_csv(<span style="color:#f1fa8c">&#34;data.csv&#34;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>read_table(<span style="color:#f1fa8c">&#34;data.tsv&#34;</span>)
</span></span></code></pre></div><p><code>sep</code> オプションを使用することで区切り文字を指定できる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>read_csv(<span style="color:#f1fa8c">&#34;data.csv&#34;</span>, sep <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;¥t&#34;</span>)
</span></span></code></pre></div><p><code>dtype</code> オプションを指定することで、読み込み時のデータ型を指定できる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>read_csv(<span style="color:#f1fa8c">&#34;data.csv&#34;</span>, dtype <span style="color:#ff79c6">=</span> {<span style="color:#f1fa8c">&#34;name&#34;</span>: <span style="color:#f1fa8c">&#34;object&#34;</span>, <span style="color:#f1fa8c">&#34;age&#34;</span>: <span style="color:#f1fa8c">&#34;object&#34;</span>}) <span style="color:#6272a4"># 列を指定して文字列で読み込み</span>
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>read_csv(<span style="color:#f1fa8c">&#34;data.csv&#34;</span>, dtype <span style="color:#ff79c6">=</span> {<span style="color:#bd93f9">0</span>: <span style="color:#f1fa8c">&#34;object&#34;</span>, <span style="color:#bd93f9">1</span>: <span style="color:#f1fa8c">&#34;object&#34;</span>}) <span style="color:#6272a4"># カラム番号でも可能</span>
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>read_csv(<span style="color:#f1fa8c">&#34;data.csv&#34;</span>, dtype <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;object&#34;</span>) <span style="color:#6272a4"># 全ての列を文字列で読み込み</span>
</span></span></code></pre></div><p>なお、 DataFrame ではデフォルトで欠損値を <code>NaN</code> で扱う。</p>
<h2 id="変換">変換</h2>
<p>Series を DataFrame へ変換する。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>DataFrame(se)
</span></span></code></pre></div><h2 id="検索">検索</h2>
<p><code>[]</code> 内に <code>True</code> または <code>False</code> を返す式を指定する。<br>
検索でヒットしたセルにそのまま値を代入できる。</p>
<pre tabindex="0"><code># &#34;age&#34; 列の値が 10 より大きい行を取得
df[df.age &gt; 10]

   name   age
1  Jiro  20.0
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6272a4"># 値が 0 より大きい値のみを取得</span>
</span></span><span style="display:flex;"><span>df[df <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   name   age
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>  Taro   NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>  Jiro  <span style="color:#bd93f9">20.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>  Goro   NaN
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6272a4"># 検索でヒットしたセルに値を代入</span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>age[df<span style="color:#ff79c6">.</span>age <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">10</span>] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   name    age
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>  Taro   <span style="color:#bd93f9">10.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>  Jiro  <span style="color:#bd93f9">100.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>  Goro    NaN
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># SettingWithCopyWarning が出るが値は代入されている</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Warning が出ないようにするには後述の loc を使う</span>
</span></span></code></pre></div><p>後述の <code>isnull()</code> や <code>isin()</code> メソッドを使った検索も可能。</p>
<h2 id="削除">削除</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6272a4"># 行削除</span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>drop(index <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   name   age
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>  Jiro  <span style="color:#bd93f9">20.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>  Goro   NaN
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6272a4"># 列削除</span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>drop(columns <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;age&#34;</span>, inplace <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   name
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>  Taro
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>  Jiro
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>  Goro
</span></span></code></pre></div><p><code>inplace = True</code> を指定するとオブジェクトが上書きされる。<br>
また、検索条件にひっかけることで行の削除が可能。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6272a4"># age列が10以下の行を削除 = age列が10より大きい列のみ抽出</span>
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df[df<span style="color:#ff79c6">.</span>age <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">10</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   name   age
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>  Jiro  <span style="color:#bd93f9">20.0</span>
</span></span></code></pre></div><h2 id="追加">追加</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df2 <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>DataFrame([[<span style="color:#f1fa8c">&#34;Rokuro&#34;</span>, <span style="color:#bd93f9">60</span>]], columns<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#34;name&#34;</span>, <span style="color:#f1fa8c">&#34;age&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># 行追加</span>
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>append(df2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     name   age
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>    Taro  <span style="color:#bd93f9">10.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>    Jiro  <span style="color:#bd93f9">20.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>    Goro   NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>  Rokuro  <span style="color:#bd93f9">60.0</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>se <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>Series([<span style="color:#f1fa8c">&#34;male&#34;</span>, <span style="color:#f1fa8c">&#34;female&#34;</span>, <span style="color:#f1fa8c">&#34;male&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># 列追加</span>
</span></span><span style="display:flex;"><span>df[<span style="color:#f1fa8c">&#34;sex&#34;</span>] <span style="color:#ff79c6">=</span> se
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   name   age     sex
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>  Taro  <span style="color:#bd93f9">10.0</span>    male
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>  Jiro  <span style="color:#bd93f9">20.0</span>  female
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>  Goro   NaN    male
</span></span></code></pre></div><h2 id="列取得">列取得</h2>
<p>一列取得した場合は <strong>Series</strong> になる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>name
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># print(df[&#34;name&#34;]) も同じ</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>      Taro
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>      Jiro
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>      Goro
</span></span><span style="display:flex;"><span>Name: name, dtype: <span style="color:#8be9fd;font-style:italic">object</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(df[[<span style="color:#f1fa8c">&#34;name&#34;</span>, <span style="color:#f1fa8c">&#34;age&#34;</span>]])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   name   age
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>  Taro  <span style="color:#bd93f9">10.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>  Jiro  <span style="color:#bd93f9">20.0</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>  Goro   NaN
</span></span></code></pre></div><h2 id="検索-1">検索</h2>
<p><a href="https://qiita.com/tanemaki/items/2ed05e258ef4c9e6caac">https://qiita.com/tanemaki/items/2ed05e258ef4c9e6caac</a></p>
<h1 id="属性attributes">属性（Attributes）</h1>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">T</td>
<td style="text-align:left">転置行列</td>
</tr>
<tr>
<td style="text-align:left">at</td>
<td style="text-align:left">後述</td>
</tr>
<tr>
<td style="text-align:left">axes</td>
<td style="text-align:left">行ラベルと列ラベルの情報</td>
</tr>
<tr>
<td style="text-align:left">blocks</td>
<td style="text-align:left">辞書形式の内部属性</td>
</tr>
<tr>
<td style="text-align:left">columns</td>
<td style="text-align:left">列ラベル</td>
</tr>
<tr>
<td style="text-align:left">dtypes</td>
<td style="text-align:left">オブジェクトのデータタイプ</td>
</tr>
<tr>
<td style="text-align:left">empty</td>
<td style="text-align:left">中身が完全に空の時、Trueを返す</td>
</tr>
<tr>
<td style="text-align:left">ftypes</td>
<td style="text-align:left">オブジェクトの ftypes を Series 形式で返却</td>
</tr>
<tr>
<td style="text-align:left">iat</td>
<td style="text-align:left">後述</td>
</tr>
<tr>
<td style="text-align:left">iloc</td>
<td style="text-align:left">後述</td>
</tr>
<tr>
<td style="text-align:left">index</td>
<td style="text-align:left">行ラベル</td>
</tr>
<tr>
<td style="text-align:left">is_copy</td>
<td style="text-align:left">不明</td>
</tr>
<tr>
<td style="text-align:left">ix</td>
<td style="text-align:left">非推奨</td>
</tr>
<tr>
<td style="text-align:left">loc</td>
<td style="text-align:left">後述</td>
</tr>
<tr>
<td style="text-align:left">ndim</td>
<td style="text-align:left">何次元配列か返却</td>
</tr>
<tr>
<td style="text-align:left">shape</td>
<td style="text-align:left">行と列のサイズ</td>
</tr>
<tr>
<td style="text-align:left">size</td>
<td style="text-align:left">行列の要素数（行サイズは <code>len(df.index)</code> 、列サイズは <code>len(df.columns)</code> ）</td>
</tr>
<tr>
<td style="text-align:left">style</td>
<td style="text-align:left">Stylerオブジェクトを返却</td>
</tr>
<tr>
<td style="text-align:left">values</td>
<td style="text-align:left">numpy.ndarray 形式で値を取得</td>
</tr>
</tbody>
</table>
<h2 id="at--iat--loc--iloc"><code>at</code> 、 <code>iat</code> 、 <code>loc</code> 、 <code>iloc</code></h2>
<ul>
<li>単独の値（スカラー）にアクセスするのが <code>at</code> と <code>iat</code></li>
<li>単独の値（スカラー）および複数の値（ベクトル）にアクセスするのが <code>loc</code> と <code>iloc</code></li>
<li>行ラベル（行名）、列ラベル（列名）で位置を指定するのが <code>at</code> と <code>loc</code></li>
<li>行番号、列番号で位置を指定するのが <code>iat</code> と <code>iloc</code></li>
<li>処理速度は <code>at</code> と <code>iat</code> のほうが <code>loc</code> と <code>iloc</code> よりも高速</li>
</ul>
<p>なお、 <code>DataFrame.get_value()</code> 、 <code>DataFrame.ix[]</code> もあるが、それぞれバージョン <code>v0.21.0</code> <code>v0.20.0</code> から非推奨（Deprecated）になっている。これから新しく書くコードには <code>at</code> , <code>iat</code> , <code>loc</code> , <code>iloc</code> を使うほうがいいだろう。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6272a4"># USAGE</span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>at[行条件, 列条件]
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>iat[行条件, 列条件]
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>loc[行条件, 列条件]
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>iloc[行条件, 列条件]
</span></span></code></pre></div><p><code>at</code> は行ラベルと列ラベルで位置を指定する。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>at[<span style="color:#bd93f9">1</span>, <span style="color:#f1fa8c">&#34;age&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># 20.0</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># numpy.float64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>at[<span style="color:#bd93f9">2</span>, <span style="color:#f1fa8c">&#34;name&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># &#39;Goro&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># str</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>at[<span style="color:#bd93f9">1</span>, <span style="color:#f1fa8c">&#34;age&#34;</span>] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">60</span> <span style="color:#6272a4"># 代入も可能</span>
</span></span></code></pre></div><p><code>iat</code> は行番号と列番号で位置を指定する。行番号・列番号は <code>0</code> はじまり。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>iat[<span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">0</span>]
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># &#39;Taro&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>iat[<span style="color:#bd93f9">2</span>, <span style="color:#bd93f9">1</span>]
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># nan</span>
</span></span></code></pre></div><p><code>loc</code> はスライス <code>x:y</code> やリスト <code>[x, y]</code> でデータの範囲・位置を指定する。参照される値は pandas.Series または pandas.DataFrame になる。<br>
列の指定を省略すると、列全体の参照になる。<br>
列全体を参照したい場合は、行の指定を <code>:</code> （全体のスライス）にする。<br>
また、行の指定には <code>df.age&gt;10</code> のような <strong>検索条件</strong> を指定することもできる。<br>
<code>loc</code> で取得したセルに対して <strong>値を代入</strong> することができる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>loc[<span style="color:#bd93f9">0</span>:<span style="color:#bd93f9">1</span>, <span style="color:#f1fa8c">&#34;name&#34;</span>:<span style="color:#f1fa8c">&#34;age&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>loc[[<span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">2</span>], [<span style="color:#f1fa8c">&#34;name&#34;</span>, <span style="color:#f1fa8c">&#34;age&#34;</span>]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>loc[<span style="color:#bd93f9">0</span>:<span style="color:#bd93f9">2</span>, <span style="color:#f1fa8c">&#34;age&#34;</span>] <span style="color:#ff79c6">=</span> [<span style="color:#bd93f9">20</span>, <span style="color:#bd93f9">30</span>, <span style="color:#bd93f9">40</span>] <span style="color:#6272a4"># 代入</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df<span style="color:#ff79c6">.</span>loc[df<span style="color:#ff79c6">.</span>age<span style="color:#ff79c6">&gt;</span><span style="color:#bd93f9">10</span>, <span style="color:#f1fa8c">&#34;age&#34;</span>] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">20</span> <span style="color:#6272a4"># 検索結果が複数行でも代入可能</span>
</span></span></code></pre></div><h1 id="代表的なメソッド">代表的なメソッド</h1>
<table>
<thead>
<tr>
<th style="text-align:left">メソッド</th>
<th style="text-align:left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>apply(関数・Lambda)</code></td>
<td style="text-align:left">各列に任意の処理を適用</td>
</tr>
<tr>
<td style="text-align:left"><code>astype({辞書型})</code></td>
<td style="text-align:left">型変換</td>
</tr>
<tr>
<td style="text-align:left"><code>replace(&quot;置換対象文字&quot;, &quot;置換文字&quot;)</code></td>
<td style="text-align:left">文字の置換</td>
</tr>
<tr>
<td style="text-align:left"><code>rename(columns={辞書型}, inplace=True)</code></td>
<td style="text-align:left">カラム名の変更</td>
</tr>
<tr>
<td style="text-align:left"><code>isin(リスト)</code></td>
<td style="text-align:left">セルの値がリストに含まれていれば True 、そうでなければ False の DataFrame を返却する</td>
</tr>
<tr>
<td style="text-align:left"><code>isnull()</code></td>
<td style="text-align:left">セルが None であれば True 、そうでなければ False の DataFrame を返却する</td>
</tr>
<tr>
<td style="text-align:left"><code>drop_duplicates()</code></td>
<td style="text-align:left">重複を削除</td>
</tr>
<tr>
<td style="text-align:left"><code>pivot_table(index=[], columns=[],values=[, aggfunc='sum')</code></td>
<td style="text-align:left">ピボットテーブル</td>
</tr>
<tr>
<td style="text-align:left"><code>sort_values(by=)</code></td>
<td style="text-align:left">ソート</td>
</tr>
</tbody>
</table>
<h1 id="sql-ライクな操作">SQL ライクな操作</h1>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/comparison_with_sql.html">公式ドキュメント</a></li>
</ul>
<h2 id="wherer"><code>wherer</code></h2>
<p>条件式が成り立つものをとってきて，それ以外はNaNで埋める。</p>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.where.html">公式ドキュメント</a></li>
</ul>
<h2 id="groupby"><code>groupby</code></h2>
<p><code>groupby</code> でカラムを指定し、様々な集計関数を適用することができる。</p>
<table>
<thead>
<tr>
<th style="text-align:left">項目</th>
<th style="text-align:left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>df.groupby('a').mean()</code></td>
<td style="text-align:left">平均</td>
</tr>
<tr>
<td style="text-align:left"><code>df.groupby('a').max()</code></td>
<td style="text-align:left">最大値</td>
</tr>
<tr>
<td style="text-align:left"><code>df.groupby('a').min()</code></td>
<td style="text-align:left">最小値</td>
</tr>
<tr>
<td style="text-align:left"><code>df.groupby('a').count()</code></td>
<td style="text-align:left">出現回数</td>
</tr>
<tr>
<td style="text-align:left"><code>df.groupby('a').sum()</code></td>
<td style="text-align:left">合計値</td>
</tr>
<tr>
<td style="text-align:left"><code>df.groupby('a').std()</code></td>
<td style="text-align:left">標準偏差</td>
</tr>
<tr>
<td style="text-align:left"><code>df.groupby('a').sum()</code></td>
<td style="text-align:left">合計値</td>
</tr>
</tbody>
</table>
<p>集計のキーをインデックスとして扱いたくない場合はオプション <code>as_index=False</code> を指定する。</p>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/api.html#groupby">公式ドキュメント</a></li>
</ul>
<h2 id="merge"><code>merge</code></h2>
<p>いわゆる JOIN 。</p>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html#pandas.DataFrame.merge">公式ドキュメント</a></li>
</ul>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/python-data-analytics-basics/" data-toggle="tooltip" data-placement="top" title="Pythonでデータ分析入門">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/nginx-basics/" data-toggle="tooltip" data-placement="top" title="Nginx入門">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>
                

            </div>

            
            
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
            

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        <a href="/tags/android" title="android">
                            android
                        </a>
                        
                        
                        
                        <a href="/tags/angular" title="angular">
                            angular
                        </a>
                        
                        
                        
                        <a href="/tags/anyenv" title="anyenv">
                            anyenv
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/aws" title="aws">
                            aws
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/cognito" title="cognito">
                            cognito
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/dynamodb" title="dynamodb">
                            dynamodb
                        </a>
                        
                        
                        
                        <a href="/tags/express" title="express">
                            express
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/git" title="git">
                            git
                        </a>
                        
                        
                        
                        <a href="/tags/github" title="github">
                            github
                        </a>
                        
                        
                        
                        <a href="/tags/go" title="go">
                            go
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/homebrew" title="homebrew">
                            homebrew
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/istio" title="istio">
                            istio
                        </a>
                        
                        
                        
                        <a href="/tags/java" title="java">
                            java
                        </a>
                        
                        
                        
                        <a href="/tags/javascript" title="javascript">
                            javascript
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/kubernetes" title="kubernetes">
                            kubernetes
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/machine-learning" title="machine-learning">
                            machine-learning
                        </a>
                        
                        
                        
                        <a href="/tags/maven" title="maven">
                            maven
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/node.js" title="node.js">
                            node.js
                        </a>
                        
                        
                        
                        <a href="/tags/npm" title="npm">
                            npm
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/pandas" title="pandas">
                            pandas
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/python" title="python">
                            python
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/scikit-learn" title="scikit-learn">
                            scikit-learn
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/svm" title="svm">
                            svm
                        </a>
                        
                        
                        
                        <a href="/tags/typescript" title="typescript">
                            typescript
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/vscode" title="vscode">
                            vscode
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/yarn" title="yarn">
                            yarn
                        </a>
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                    

                    
                    <li>
                        <a href="https://twitter.com/peepeese">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    

                    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/pepese">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    
                    
                    
                    
                    
                    
            
            
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; ぺーぺーSEのブログ 2022
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function loadAsync(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        loadAsync("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-42388425-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>






<script type="text/javascript">
    function generateCatalog(selector) {

        
        
        
        
            _containerSelector = 'div.post-container'
        

        
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        
        $(selector).html('')

        
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    


    loadAsync("\/js\/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>


</body>
</html>
